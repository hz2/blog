<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Cheating Discrete Log Exactly Once | jd blog</title><meta name=keywords content="cryptography,diffie-hellman,bilinear maps"><meta name=description content="Joux's 3-party Diffie-Hellman"><meta name=author content="Jason"><link rel=canonical href=http://localhost:1313/posts/joux3p/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/white_logo.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/white_logo.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/white_logo.png><link rel=apple-touch-icon href=http://localhost:1313/white_logo.png><link rel=mask-icon href=http://localhost:1313/white_logo.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/joux3p/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css integrity=sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js integrity=sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!0})'></script><meta property="og:url" content="http://localhost:1313/posts/joux3p/"><meta property="og:site_name" content="jd blog"><meta property="og:title" content="Cheating Discrete Log Exactly Once"><meta property="og:description" content="Joux's 3-party Diffie-Hellman"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-22T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-22T00:00:00+00:00"><meta property="article:tag" content="Cryptography"><meta property="article:tag" content="Diffie-Hellman"><meta property="article:tag" content="Bilinear Maps"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Cheating Discrete Log Exactly Once"><meta name=twitter:description content="Joux's 3-party Diffie-Hellman"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Cheating Discrete Log Exactly Once","item":"http://localhost:1313/posts/joux3p/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cheating Discrete Log Exactly Once","name":"Cheating Discrete Log Exactly Once","description":"Joux's 3-party Diffie-Hellman","keywords":["cryptography","diffie-hellman","bilinear maps"],"articleBody":"Bilinear Maps Let $G_1, G_2$, and $G_t$ be cyclic groups of the same order. A bilinear map from $G_1 \\times G_2$ to $G_t$ is a function $e$: $$ e: G_1 \\times G_2 \\rightarrow G_t \\text{ such that } \\forall u \\in G_1, v \\in G_2, a, b \\in \\mathbb{Z} \\newline e(u^a, v^b) = e(u,v)^{ab} $$ Bilinear maps are also called pairings because they pair elements from $G_1, G_2$ and map them to an element in $G_t$. The above definition assumes that degenerate maps which map everything to the identity $G_t$.\nAn Admissible Bilinear Map is as follows:\nLet $e : G_1 \\times G_2 \\rightarrow G_t$ be a bilinear map.\nLet $g_1$ and $g_2$ be generators of $G_1$ and $G_2$ respectively.\nThe map $e$ is admissible bilinear map if $e(g_1, g_2)$ generates $G_t$ and $e$ is efficiently computable.\nThe relationship between $G_1, G_2$ and $G_t$:\n$G_1, G_2$ and $G_t$ are all isopmorphic to one another since they have the same order and are cyclic They are different groups in the sense that we represent the elements and compute the operations differently Normally, however, $G_1=G_2$ (in addition to being isopmorphic), we will now denote both by $G = G_1 = G_2$ $G$ and $G_t$ may have either composite or prime order which makes a difference how they work and are used If $G=G_t$ it’s called a self-bilinear map and is very powerful, no known examples, still an open problem. Groups Typically $G$ is an elliptic curve (or subgroup), e.g. the elliptic curve defined by $y^2 = x^3 + 1$ over the finite field $F_p$. More generally, $G$ is typically abelian variety over some field. $G_t$ is normally a finite field.\nDecisional Diffie-Hellman (DDH) Let $G$ be a group of order $q$ with generator $g$. The advantage of an probabilistic algorithm $\\mathcal{A}$ in solving the Decisional Diffie-Hellman problem in $G$ is:\n$$ \\text{Adv}^{\\text{DDH}}_{\\mathcal{A},G} = | \\Pr[\\mathcal{A}(g, g^a, g^b, g^{ab}) = 1] - P[\\mathcal{A}(g, g^a, g^b, g^z)=1] | $$\nwhere $a,b,z$ are drawn uniformly at random from $\\Z_q$ and the probability is taken over choices $a,b,z$ and $\\mathcal{A}$’s coin flips.\nA property of the bilinear map is that it makes DDH easy in $G$ such that with a bilinear map $e: G \\times G \\rightarrow G_t$, a polynomial time $\\mathcal{A}$ may gain advantage. Given $g, g^a, g^b, g^c$, determine whether $c \\equiv ab \\mod q$ by checking $e(g^a, g^b) = e(g, g^c)$. However if the map is from distinct groups $G_1, G_2$ then DDH may still be hard in $G_1$ (or $G_2$) which is only possible if there is no efficiently computable isomorphic between $G_1$ and $G_2$\nDiscrete Log If there exists a bilinear map $e: G \\times G \\rightarrow G_t$, then the discrete log problem in $G$ is no harder than the discrete log problem in $G_t$. That is, given $g \\in G$ and $g^a \\in G$, we can compute $e(g,g) \\in G_t$ and $e(g,g^a) = e(g, g)^a \\in G_t$. Then we can use a discrete log solver for $G_t$ to obtain $a$. This is called the Menezes, Okamoto, Vanstone (MOV) reduction1.\nJoux’s 3-Party Diffie-Hellman Let $G$ be a group with prime order $1, e : G \\times G \\rightarrow G_t$ be a bilinear map, and $g$ be a generator of $G$. Let $\\hat{g} = e(g, g) \\in G_t$.\nProtocol Alice picks $a \\leftarrow \\mathbb{Z}$ Alice, Bob, Carol broadcast $g^a, g^b, g^c$ respectively Alice computes $e(g^b, g^c)^a = \\hat{g}^{abc}$, Bob computes $e(g^c, g^a)^b = \\hat{g}^{abc}$, and Carol computes $e(g^a, g^b)^c = \\hat{g}^{abc}$. The “Cheat” From Alice’s perspective, the bilinear map lets you “cheat” to get $\\hat{g}^bc$ from $g^b$ and $g^c$. Then, regular exponentiation gets you the rest of the way to $\\hat{g}^{abc}$. You can not use $e$ to get $\\hat{g}^{abc}$ from the broadcasted $g^a, g^b, g^c$. Formally, $$ e(g^a, e(g^b, g^c)) = e(g^a, \\hat{g}^{bc}) \\neq \\hat{g}^{abc} $$ i.e. $\\hat{g}^{bc}$ not in $G$, thus, only one cheat is allowed.\nReducing elliptic curve logarithms to logarithms in a finite field ↩︎\n","wordCount":"655","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-11-22T00:00:00Z","dateModified":"2024-11-22T00:00:00Z","author":[{"@type":"Person","name":"Jason"}],"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/joux3p/"},"publisher":{"@type":"Organization","name":"jd blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/white_logo.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/black_logo.png alt aria-label=logo height=70>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/cv/ title=cv><span>cv</span></a></li><li><a href=http://localhost:1313/notes/ title=notes><span>notes</span></a></li><li><a href=http://localhost:1313/reads/ title=reads><span>reads</span></a></li><li><a href=http://localhost:1313/posts/ title=blog><span>blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Cheating Discrete Log Exactly Once</h1><div class=post-description>Joux's 3-party Diffie-Hellman</div><div class=post-meta><span title='2024-11-22 00:00:00 +0000 UTC'>November 22, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;655 words&nbsp;·&nbsp;Jason&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/joux3p/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#bilinear-maps>Bilinear Maps</a><ul><li><a href=#groups>Groups</a></li></ul></li><li><a href=#decisional-diffie-hellman-ddh>Decisional Diffie-Hellman (DDH)</a></li><li><a href=#discrete-log>Discrete Log</a></li><li><a href=#jouxs-3-party-diffie-hellman>Joux&rsquo;s 3-Party Diffie-Hellman</a><ul><li><a href=#protocol>Protocol</a></li><li><a href=#the-cheat>The &ldquo;Cheat&rdquo;</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=bilinear-maps>Bilinear Maps<a hidden class=anchor aria-hidden=true href=#bilinear-maps>#</a></h2><p>Let $G_1, G_2$, and $G_t$ be cyclic groups of the same order.
A bilinear map from $G_1 \times G_2$ to $G_t$ is a function $e$:
$$
e: G_1 \times G_2 \rightarrow G_t \text{ such that } \forall u \in G_1, v \in
G_2, a, b \in \mathbb{Z} \newline
e(u^a, v^b) = e(u,v)^{ab}
$$
Bilinear maps are also called pairings because they pair elements from $G_1,
G_2$ and map them to an element in $G_t$.
The above definition assumes that degenerate maps which map everything to the
identity $G_t$.</p><p>An Admissible Bilinear Map is as follows:</p><p>Let $e : G_1 \times G_2 \rightarrow G_t$ be a bilinear map.</p><p>Let $g_1$ and $g_2$ be generators of $G_1$ and $G_2$ respectively.</p><p>The map $e$ is <em>admissible</em> bilinear map if $e(g_1, g_2)$ generates $G_t$ and
$e$ is efficiently computable.</p><p>The relationship between $G_1, G_2$ and $G_t$:</p><ul><li>$G_1, G_2$ and $G_t$ are all isopmorphic to one another since they have the
same order and are cyclic</li><li>They are different groups in the sense that we represent the elements and
compute the operations differently</li><li>Normally, however, $G_1=G_2$ (in addition to being isopmorphic), we will
now denote both by $G = G_1 = G_2$</li><li>$G$ and $G_t$ may have either composite or prime order which makes a
difference how they work and are used</li><li>If $G=G_t$ it&rsquo;s called a self-bilinear map and is very powerful, no known
examples, still an open problem.</li></ul><h3 id=groups>Groups<a hidden class=anchor aria-hidden=true href=#groups>#</a></h3><p>Typically $G$ is an elliptic curve (or subgroup), e.g. the elliptic curve
defined by $y^2 = x^3 + 1$ over the finite field $F_p$. More generally, $G$ is
typically abelian variety over some field. $G_t$ is normally a finite field.</p><h2 id=decisional-diffie-hellman-ddh>Decisional Diffie-Hellman (DDH)<a hidden class=anchor aria-hidden=true href=#decisional-diffie-hellman-ddh>#</a></h2><p>Let $G$ be a group of order $q$ with generator $g$. The advantage of an
probabilistic algorithm $\mathcal{A}$ in solving the Decisional Diffie-Hellman
problem in $G$ is:</p><p>$$
\text{Adv}^{\text{DDH}}_{\mathcal{A},G} = | \Pr[\mathcal{A}(g, g^a, g^b, g^{ab}) = 1] -
P[\mathcal{A}(g, g^a, g^b, g^z)=1] |
$$</p><p>where $a,b,z$ are drawn uniformly at random from $\Z_q$ and the probability is
taken over choices $a,b,z$ and $\mathcal{A}$&rsquo;s coin flips.</p><p>A property of the bilinear map is that it makes DDH easy in $G$ such that with a
bilinear map $e: G \times G \rightarrow G_t$, a polynomial time $\mathcal{A}$
may gain advantage. Given $g, g^a, g^b, g^c$, determine whether $c \equiv ab
\mod q$ by checking $e(g^a, g^b) = e(g, g^c)$. However if the map is from
distinct groups $G_1, G_2$ then DDH may still be hard in $G_1$ (or $G_2$) which
is only possible if there is no efficiently computable isomorphic between $G_1$
and $G_2$</p><h2 id=discrete-log>Discrete Log<a hidden class=anchor aria-hidden=true href=#discrete-log>#</a></h2><p>If there exists a bilinear map $e: G \times G \rightarrow G_t$, then the
discrete log problem in $G$ is no harder than the discrete log problem in $G_t$.
That is, given $g \in G$ and $g^a \in G$, we can compute $e(g,g) \in G_t$ and
$e(g,g^a) = e(g, g)^a \in G_t$. Then we can use a discrete log solver for $G_t$
to obtain $a$. This is called the Menezes, Okamoto, Vanstone (MOV)
reduction<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><h2 id=jouxs-3-party-diffie-hellman>Joux&rsquo;s 3-Party Diffie-Hellman<a hidden class=anchor aria-hidden=true href=#jouxs-3-party-diffie-hellman>#</a></h2><p>Let $G$ be a group with prime order $1, e : G \times G \rightarrow G_t$ be a
bilinear map, and $g$ be a generator of $G$. Let $\hat{g} = e(g, g) \in G_t$.</p><h3 id=protocol>Protocol<a hidden class=anchor aria-hidden=true href=#protocol>#</a></h3><ol><li>Alice picks $a \leftarrow \mathbb{Z}$</li><li>Alice, Bob, Carol broadcast $g^a, g^b, g^c$ respectively</li><li>Alice computes $e(g^b, g^c)^a = \hat{g}^{abc}$, Bob computes $e(g^c, g^a)^b =
\hat{g}^{abc}$, and Carol computes $e(g^a, g^b)^c = \hat{g}^{abc}$.</li></ol><h3 id=the-cheat>The &ldquo;Cheat&rdquo;<a hidden class=anchor aria-hidden=true href=#the-cheat>#</a></h3><p>From Alice&rsquo;s perspective, the bilinear map lets you &ldquo;cheat&rdquo; to get $\hat{g}^bc$
from $g^b$ and $g^c$. Then, regular exponentiation gets you the rest of the way
to $\hat{g}^{abc}$. You <strong>can not</strong> use $e$ to get $\hat{g}^{abc}$ from the
broadcasted $g^a, g^b, g^c$. Formally,
$$
e(g^a, e(g^b, g^c)) = e(g^a, \hat{g}^{bc}) \neq \hat{g}^{abc}
$$
i.e. $\hat{g}^{bc}$ not in $G$, thus, only one cheat is allowed.</p><hr><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://ieeexplore.ieee.org/document/259647>Reducing elliptic curve logarithms to logarithms in a finite field</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/cryptography/>Cryptography</a></li><li><a href=http://localhost:1313/tags/diffie-hellman/>Diffie-Hellman</a></li><li><a href=http://localhost:1313/tags/bilinear-maps/>Bilinear Maps</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>jd blog</a></span> ·
<span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>